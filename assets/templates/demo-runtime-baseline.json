{
  "id": "demo-runtime-baseline-v1",
  "name": "Demo Runtime Baseline v1",
  "mode": "manage",
  "vars": {
    "INSTALL_ROOT": {
      "type": "string",
      "group": "paths",
      "required": true,
      "example": "/data/opskit-demo",
      "description": "output root for state/reports"
    },
    "EVIDENCE_DIR": {
      "type": "string",
      "group": "paths",
      "required": true,
      "example": "/data/opskit-demo/evidence",
      "description": "evidence directory root"
    },
    "ROOT_MOUNT": {
      "type": "string",
      "group": "runtime",
      "required": true,
      "default": "/",
      "example": "/",
      "description": "target mount for runtime checks"
    },
    "DNS_HOST": {
      "type": "string",
      "group": "network",
      "required": true,
      "default": "localhost",
      "example": "localhost",
      "description": "host used in dns_resolve check"
    },
    "PROFILE": {
      "type": "string",
      "group": "runtime",
      "required": false,
      "default": "baseline",
      "example": "baseline",
      "description": "profile label for generated evidence filenames"
    }
  },
  "stages": {
    "A": {
      "checks": [
        {
          "id": "a.system_info",
          "kind": "system_info",
          "enabled": true
        },
        {
          "id": "a.mount_check",
          "kind": "mount_check",
          "params": {
            "required_mounts": ["${ROOT_MOUNT}"]
          },
          "enabled": true
        },
        {
          "id": "a.time_sync_status",
          "kind": "time_sync_status",
          "params": {
            "severity": "warn"
          },
          "enabled": true
        }
      ]
    },
    "D": {
      "checks": [
        {
          "id": "d.disk_usage_root",
          "kind": "disk_usage",
          "params": {
            "mount": "${ROOT_MOUNT}",
            "max_used_percent": 90,
            "severity": "warn"
          },
          "enabled": true
        },
        {
          "id": "d.memory_available",
          "kind": "memory_available",
          "params": {
            "min_available_mb": 512,
            "severity": "warn"
          },
          "enabled": true
        },
        {
          "id": "d.load_average",
          "kind": "load_average",
          "params": {
            "max_load1": 4,
            "severity": "warn"
          },
          "enabled": true
        },
        {
          "id": "d.ntp_sync",
          "kind": "ntp_sync",
          "params": {
            "severity": "warn"
          },
          "enabled": true
        },
        {
          "id": "d.dns_resolve",
          "kind": "dns_resolve",
          "params": {
            "host": "${DNS_HOST}",
            "min_records": 1,
            "severity": "warn"
          },
          "enabled": true
        }
      ]
    },
    "F": {
      "evidence": [
        {
          "id": "f.overall_json_hash",
          "kind": "file_hash",
          "params": {
            "file": "${INSTALL_ROOT}/state/overall.json",
            "output": "${EVIDENCE_DIR}/${PROFILE}-overall-json-hash.json"
          },
          "enabled": true
        },
        {
          "id": "f.state_dir_hash",
          "kind": "dir_hash",
          "params": {
            "dir": "${INSTALL_ROOT}/state",
            "output": "${EVIDENCE_DIR}/${PROFILE}-state-dir-hash.json"
          },
          "enabled": true
        },
        {
          "id": "f.date_snapshot",
          "kind": "command_output",
          "params": {
            "name": "date",
            "args": ["-u", "+%Y-%m-%dT%H:%M:%SZ"],
            "output": "${EVIDENCE_DIR}/${PROFILE}-utc-date.json"
          },
          "enabled": true
        }
      ]
    }
  }
}
