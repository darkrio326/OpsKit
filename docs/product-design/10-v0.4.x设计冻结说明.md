# v0.4.x 设计冻结说明（Design Freeze）

本文定义 v0.4.x 阶段的设计冻结边界，作为实现评审和发版门禁依据。

## 1. 冻结目标

- 保持 OpsKit 生命周期语义稳定（A-F 不变）
- 保持模板交付门禁稳定（以 `DELIVERY_GATE` 为准）
- 在不修改引擎核心语义的前提下推进 M4 模板扩展

## 2. 冻结范围（禁止变更）

- 禁止新增/删除生命周期阶段
- 禁止修改 `executil` 作为统一执行入口的约束
- 禁止改变全局锁冲突退出码（`4`）语义
- 禁止改变“Check 只读、不做持久化状态变更”的规则
- 禁止在 UI 中引入模板编辑或执行逻辑

## 3. 允许变更（可继续开发）

- 新增或增强模板（黑箱管理 / 自部署）
- 新增通用检查插件、证据采集插件
- 文档补齐、门禁脚本补齐、变量样例补齐
- UI 展示增强（状态、模板分组、证据入口）

## 4. 变更申请机制（超出冻结范围时）

若某项需求必须突破冻结范围，需先完成以下 3 步：

1. 在设计文档中提交变更说明（影响范围、回滚方案、兼容策略）
2. 与产品负责人确认并获得明确同意
3. 更新 `ROADMAP` 与相关门禁文档后再实施代码变更

未完成以上步骤的变更，视为不允许合入。

## 5. 与门禁文档关系

- 模板交付门禁：`docs/product-design/DELIVERY_GATE.md`
- 模板设计规则：`docs/product-design/09-模板设计指南.md`
- 路线图基线：`ROADMAP.md`

## 6. 生效版本

- 生效起点：`v0.4.1-preview.1`
- 生效范围：全部 `v0.4.x` preview 版本，直到进入下一里程碑并重新评审
