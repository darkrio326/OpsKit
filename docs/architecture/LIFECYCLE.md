LIFECYCLE.md（工程化草案 v1）

1. 项目目标
OpsKit 是一套 面向信创离线环境的服务器全生命周期自动化运维工具，
用于在 最少人工干预 的前提下，完成从服务器接管到生产交付的全过程，并为每一个阶段提供 可审计、可复现、可交付的运维证据。

⸻

2. OpsKit 的介入时机
OpsKit 从 服务器首次接管 即开始介入，直至 服务器完成生产交付并进入稳定期。

OpsKit 覆盖但不限于以下阶段：
	•	裸机 / 新装系统
	•	已存在系统的接管
	•	应用部署与运维
	•	异常与断电恢复
	•	项目验收与交付

⸻

3. 生命周期阶段划分（收敛后的版本）
⚠️ 这里是关键：阶段一定要少、职责一定要清晰

阶段 A：接管与基线检查（Preflight）

解决的风险
	•	系统不符合信创/项目要求
	•	基础环境隐患在上线后爆雷

主要动作
	•	系统架构 / OS / 内核 / 时区 / 时间同步
	•	磁盘与挂载状态
	•	网络、路由、防火墙状态
	•	端口占用
	•	已安装组件与依赖扫描

输出
	•	preflight-report.html
	•	风险项 + 修复建议（不默认自动修复）

⸻

阶段 B：基线初始化（Baseline）

解决的风险
	•	每台服务器“各玩各的”
	•	人走了没人知道之前怎么配的

主要动作
	•	运维目录结构初始化（/opt /data /logs）
	•	基础用户 / 权限 / sudo 策略
	•	systemd 基础规范
	•	日志与时间策略

输出
	•	baseline-report.html
	•	基线状态快照（hash）

⸻

阶段 C：用途声明与部署（Deploy）

解决的风险
	•	部署靠记忆
	•	服务顺序错 / 配置不一致

主要动作
	•	声明服务器用途（OA / ELK / MinIO 等）
	•	依据用途创建目录与用户
	•	离线包部署
	•	systemd / docker-compose 注册
	•	启动与健康检查

输出
	•	deploy-<stack>-report.html
	•	当前运行版本与端口清单

⸻

阶段 D：运行与巡检（Operate）

解决的风险
	•	“看起来在跑，其实已经坏了”
	•	运维没有证据

主要动作
	•	服务状态巡检
	•	端口 / HTTP / 日志关键字检查
	•	资源阈值检查

输出
	•	巡检报告
	•	异常快照

⸻

阶段 E：异常与断电恢复（Recover）

解决的风险
	•	停电/异常后靠人
	•	恢复过程不可控

主要动作
	•	开机自检
	•	环境就绪判定
	•	按依赖顺序恢复服务
	•	有限重试 + 人工兜底

输出
	•	recovery-report.html
	•	恢复时间线

⸻

阶段 F：验收与交付（Accept / Handover）

解决的风险
	•	验收靠截图、靠嘴
	•	补丁无证据

主要动作
	•	前端 / 后端 / 配置补丁识别
	•	hash / 路径 / 生效状态
	•	汇总生命周期报告

输出
	•	acceptance/
	•	handover-report.html

⸻

4. 自动化与人工边界（这是非常成熟的点）
默认自动
	•	系统自检
	•	服务健康检查
	•	程序更新自动部署（监听指定目录）
	•	补丁证据生成
	•	巡检与恢复

必须人工确认
	•	服务下线
	•	危险修复操作（数据删除、fsck 等）
	•	安全相关策略变更

⸻

5. 最终交付形态
	•	一个 单一可执行文件（bin）
	•	不依赖外网
	•	尽量减少运行时依赖
	•	用于：
	•	运维人员
	•	开发人员
	•	项目交付与验收

目标：

让开发专注开发，让运维从“操作员”变成“监督者”。



监听安装包目录自动重载部署
v1 只支持 显式触发，自动监听作为 v2 可选功能

一键修复服务器漏洞报告
v1 只做：
	•	漏洞项识别
	•	修复建议
	•	修复脚本生成


v1 做一个页面  运维一目了然

